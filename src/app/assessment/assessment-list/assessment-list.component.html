<div class="container" [class.is-mobile]="mobileQuery.matches">
	<mat-toolbar color="primary" class="toolbar">
		<button mat-icon-button on-click="snav.toggle()">
			<mat-icon>menu</mat-icon>
		</button>
		<h1>Setting</h1>
	</mat-toolbar>

	<mat-sidenav-container class="sidenav-container" [style.marginTop.px]="mobileQuery.matches ? 56 : 0">
		<mat-sidenav #snav [mode]="mobileQuery.matches ? 'over' : 'side'" [fixedInViewport]="mobileQuery.matches" fixedTopGap="56">
			<mat-nav-list>
				<a mat-list-item routerLink="/login">Login</a>
				<a mat-list-item routerLink="/home">Home</a>
				<a mat-list-item routerLink="/vn">VN</a>
				<a mat-list-item routerLink="/setting">Setting</a>
				<a mat-list-item routerLink="/assessment">Assesment</a>
			</mat-nav-list>
		</mat-sidenav>

		<mat-sidenav-content>
			<div class="sub-toolbar" fxLayout="row">
				<mat-select placeholder="status filter" [(ngModel)]="filter.status" (ngModelChange)="pessimisticFiltering()" class="filtering-selection">
					<mat-option value="ongoing">Ongoing</mat-option>
					<mat-option value="halted">Halted</mat-option>
					<mat-option value="finished">Dropped</mat-option>
					<mat-option value="dropped">Dropped</mat-option>
					<mat-option value="all">All</mat-option>
				</mat-select>
				<mat-select placeholder="node filter" [(ngModel)]="filter.node" (ngModelChange)="pessimisticFiltering()" class="filtering-selection">
					<mat-option value="vn">VN</mat-option>
					<mat-option value="h">Nukige</mat-option>
					<mat-option value="rpg">RPG</mat-option>
					<mat-option value="hrpg">HRPG</mat-option>
					<mat-option value="all">All</mat-option>
				</mat-select>
				<mat-select placeholder="period filter" [(ngModel)]="filter.period" (ngModelChange)="pessimisticFiltering()" class="filtering-selection">
					<mat-option value="all">All time</mat-option>
					<mat-option value="year">This year</mat-option>
					<mat-option value="yesteryear">Last year</mat-option>
				</mat-select>
				<span style="flex: 1 1 auto;"></span>
			</div>

			<table class="assessments-table">
				<thead>
					<tr>
						<th style="width: 3vw;"></th>
						<th style="width: 40vw;">Title</th>
						<th style="width: 10vw;">Predictive Eye</th>
						<th style="width: 20vw;">Status/Node/Created At</th>
						<th style="width: 5vw;"></th>
					</tr>
				</thead>
				<tbody>
					<ng-template ngFor let-assessment [ngForOf]="assessments">
						<tr>
							<td class="center-text">
								<span *ngIf="assessment.date_start && assessment.date_end && assessment.node && assessment.score_story && assessment.score_naki && assessment.score_nuki && assessment.score_comedy && assessment.score_graphic && assessment.score_all && assessment.status">&#x2713;</span>
								<span *ngIf="!assessment.date_start || !assessment.date_end || !assessment.node || !assessment.score_story || !assessment.score_naki || !assessment.score_nuki || !assessment.score_comedy || !assessment.score_graphic || !assessment.score_all || !assessment.status">&#x2718;</span>
							</td>
							<td>
								<a [routerLink]="['/vn', assessment.vn_id, 'edit']">{{assessment.title_original}}</a>
							</td>
							<td class="center-text">
								<span>{{assessment.score_story || "x"}}</span>
								<span>{{assessment.score_naki || "x"}}</span>
								<span>{{assessment.score_nuki || "x"}}</span>
								<span>{{assessment.score_comedy || "x"}}</span>
								<span>{{assessment.score_graphic || "x"}}</span>
								<span>{{assessment.score_all || "x"}}</span>
								<br />
								<p [ngSwitch]="playtimeCalculation(assessment)" title="{{assessment.date_start}} - {{assessment.date_end}}">
									<ng-template [ngSwitchCase]="0">
										uncleared yet
									</ng-template>
									<ng-template ngSwitchDefault>
										{{playtimeCalculation(assessment)}} days
									</ng-template>
								</p>
							</td>
							<td>
								<p>Status:
									<span *ngIf="assessment.date_start && !assessment.date_end && !assessment.status">reading</span>
									<span *ngIf="!assessment.date_start && !assessment.date_end && !assessment.status">idle</span>
									<span *ngIf="assessment.date_start && assessment.date_end && !assessment.status">indistinguishable</span>
									<span *ngIf="assessment.status">{{assessment.status}}</span>
								</p>
								<p>Node: {{assessment.node}}</p>
								<p>Created: {{assessment.created_at}}</p>
							</td>
							<td>
								<a mat-raised-button [routerLink]="['/assessment', assessment.id, 'fill']" color="primary" class="action-button">Compose</a>
								<a mat-raised-button [routerLink]="['/assessment', assessment.id, 'character']" color="primary" class="action-button">Character</a>
							</td>
						</tr>
					</ng-template>

				</tbody>
			</table>

		</mat-sidenav-content>
	</mat-sidenav-container>
</div>